/** 
 * ngAudio - https://github.com/danielstern/ngAudio
 * Copyright (c) daniel stern, Azureda 
 */
angular.module("ngAudio",[]).directive("ngAudio",["$compile","$q","ngAudio",function(e,b,c){return{restrict:"AEC",scope:{volume:"=",start:"=",currentTime:"=",loop:"=",clickPlay:"=",disablePreload:"="},controller:["$scope","$attrs","$element","$timeout",function(a,b,e,m){function h(){k=c.load(b.ngAudio,a);a.$audio=k;k.unbind()}var k;a.disablePreload||h();e.on("click",function(){!1!==a.clickPlay&&(a.disablePreload&&h(),k.audio.play(),k.volume=a.volume||k.volume,k.loop=a.loop,k.currentTime=a.start||
0,m(function(){k.play()},5))});e.on("$destroy",function(){k.destroy()})}]}}]).directive("ngAudioHover",["$compile","$q","ngAudio",function(e,b,c){return{restrict:"AEC",controller:["$scope","$attrs","$element","$timeout",function(a,b,e,m){var h=c.load(b.ngAudioHover,a);e.on("mouseover rollover hover",function(){h.audio.play();h.volume=b.volumeHover||h.volume;h.loop=b.loop;h.currentTime=b.startHover||0});e.on("$destroy",function(){h.destroy()})}]}}]).service("localAudioFindingService",["$q",function(e){this.find=
function(b){var c=e.defer(),a=document.getElementById(b);a?c.resolve(a):c.reject(b);return c.promise}}]).service("remoteAudioFindingService",["$q",function(e){this.find=function(b){var c=e.defer(),a=new Audio;a.addEventListener("error",function(){c.reject()});a.addEventListener("loadstart",function(){c.resolve(a)});setTimeout(function(){a.src=b},1);return c.promise}}]).service("cleverAudioFindingService",["$q","localAudioFindingService","remoteAudioFindingService",function(e,b,c){this.find=function(a){var g=
e.defer();a=a.replace("|","/");b.find(a).then(g.resolve,function(){return c.find(a)}).then(g.resolve,g.reject);return g.promise}}]).value("ngAudioGlobals",{muting:!1,performance:25,unlock:!0,volume:1}).factory("NgAudioObject",["cleverAudioFindingService","$rootScope","$interval","$timeout","ngAudioGlobals",function(e,b,c,a,g){return function(a,m){function h(){f.play();f.pause();window.removeEventListener("click",h)}function k(){r||(n&&c.cancel(n),s&&s(),l&&l(),r=!0)}function D(){r||(l=t.$watch(function(){return{volume:d.volume,
currentTime:d.currentTime,progress:d.progress,muting:d.muting,loop:d.loop,playbackRate:d.playbackRate,globalVolume:g.volume}},function(a,b){a.currentTime!==b.currentTime&&d.setCurrentTime(a.currentTime);a.progress!==b.progress&&d.setProgress(a.progress);a.volume!==b.volume&&d.setVolume(a.volume);a.playbackRate!==b.playbackRate&&d.setPlaybackRate(a.playbackRate);a.globalVolume!==b.globalVolume&&(0===a.globalVolume?d.setMuting(!0):(d.setMuting(!1),d.setVolume(a.globalVolume)));p=a.loop;a.muting!==b.muting&&
d.setMuting(a.muting)},!0))}function z(){l&&l();if(f){f.volume=u||g.muting?0:void 0!==d.volume?d.volume:1;v&&(f.play(),v=!1);w&&(f.src="about:blank",w=!1);x&&(f.pause(),x=!1);y&&(f.playbackRate=A,y=!1);q&&(f.volume=q,q=void 0);if(B){d.currentTime=f.currentTime;d.duration=f.duration;d.remaining=f.duration-f.currentTime;d.progress=0;d.paused=f.paused;d.src=f.src;var a=f.currentTime/f.duration;0<a&&(d.progress=a);d.currentTime>=d.duration&&C.forEach(function(a){a(d)});p&&d.currentTime>=d.duration&&(!0!==
p&&(p--,d.loop--),d.setCurrentTime(0),d.play())}u||g.muting||(d.volume=f.volume);d.audio=f}D()}var l,s,v=!1,x=!1,w=!1,y=!1,A=!1,q,p,u=!1,B=!0,r=!1,t=m||b,f,d=this;this.id=a;this.safeId=a.replace("/","|");this.loop=0;this.unbind=function(){B=!1};this.play=function(){v=!0;return this};var C=[];this.complete=function(a){C.push(a)};this.pause=function(){x=!0};this.restart=function(){w=!0};this.stop=function(){this.restart()};this.setVolume=function(a){q=a};this.setPlaybackRate=function(a){A=a;y=!0};this.setMuting=
function(a){u=a};this.setProgress=function(a){f&&f.duration&&isFinite(a)&&(f.currentTime=f.duration*a)};this.setCurrentTime=function(a){f&&f.duration&&(f.currentTime=a)};this.destroy=k;t.$on("$destroy",function(){k()});e.find(a).then(function(a){f=a;g.unlock&&(window.addEventListener("click",h),f.addEventListener("playing",function(){window.removeEventListener("click",h)}));f.addEventListener("canplay",function(){d.canPlay=!0})},function(a){d.error=!0;console.warn(a)});var n=c(z,g.performance);s=
t.$watch(function(){return g.performance},function(){c.cancel(n);n=c(z,g.performance)})}}]).service("ngAudio",["NgAudioObject","ngAudioGlobals",function(e,b){this.play=function(b,a){var g=new e(b,a);g.play();return g};this.load=function(b,a){return new e(b,a)};this.mute=function(){b.muting=!0};this.unmute=function(){b.muting=!1};this.toggleMute=function(){b.muting=!b.muting};this.setUnlock=function(c){b.unlock=c};this.setGlobalVolume=function(c){b.volume=c}}]).filter("trackTime",function(){return function(e){e=
Math.floor(e|0);var b="",c=b=0,a=0;3599<e?(b=Math.floor(e/3600),c=Math.floor((e-3600*b)/60),a=e-(60*c+3600*b),1==b.toString().length&&(b="0"+Math.floor(e/3600).toString()),1==c.toString().length&&(c="0"+Math.floor((e-3600*b)/60).toString()),1==a.toString().length&&(a="0"+(e-(60*c+3600*b)).toString()),b=b+":"+c+":"+a):59<e?(c=Math.floor(e/60),a=e-60*c,1==c.toString().length&&(c="0"+Math.floor(e/60).toString()),1==a.toString().length&&(a="0"+(e-60*c).toString()),b=c+":"+a):b=e+"s";if("function"===typeof Number.isNaN&&
Number.isNaN(b))debugger;return b}});
